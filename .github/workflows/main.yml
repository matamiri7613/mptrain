name: Debug Deploy

on:
  push:
    branches: [ main ]

jobs:
  debug:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v3
    
    - name: Debug SSH connection
      uses: appleboy/ssh-action@master
      with:
        host: 82.115.21.17
        username: root
        key: 133976beh
        debug: true
        script: |
          echo "SSH connection test"
          whoami
          pwd
          ls -la
    
    - name: Verify server environment
      if: success()
      uses: appleboy/ssh-action@master
      with:
        host: 82.115.21.17
        username: root
        key: 133976beh
        script: |
          echo "System information:"
          uname -a
          python3 --version
          pip3 --version || echo "pip3 not installed"
          which nginx || echo "nginx not found"
